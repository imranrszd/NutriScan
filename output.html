<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriScan - Output</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="output.css">
</head>

<body>
    <header>
        <a href="index.html">
            <p>NutriScan</p>
        </a>
    </header>
    <div class="wrapper">
        <div class="sub-wrapper">
            <h1 class=" title">Assessment Results</h1>
            <hr>
            <div class="results" id="nutrition-status">
                <div class="nutritional-stat">
                    <div class="status">
                        <p>Nutritional Status</p>
                        <h3 class="title" style="margin: 0;" id="status">SAM (Severe Acute Malnutrition)</h3>
                    </div>
                    <div class="confidence">
                        <div class="left-side">
                            <p>Confidence</p>
                            <div class="conf-level-container">
                                <div class="conf-level" id="healthy-level"></div>
                                <div class="conf-level" id="low-level"></div>
                                <div class="conf-level" id="medium-level"></div>
                                <div class="conf-level" id="high-level"></div>
                            </div>
                        </div>
                        <h3 id="confidence">High</h3>
                    </div>
                </div>
                <br>
                <div class="slider-container">
                    <div class="indicator">
                        <span>
                            <hr>
                        </span>
                        <span>
                            <hr>
                        </span>
                        <span>
                            <hr>
                        </span>
                    </div>
                    <hr>
                    <div class="slider-labels">
                        <span>HEALTHY</span>
                        <span>MAM</span>
                        <span>SAM</span>
                    </div>
                </div>
            </div>
            <hr>
            <div class="results" id="second-layer">
                <div class="type">
                    <div class="left-side">
                        <p>Type</p>
                        <h3 class="title" id="type">Kwashiorkor</h3>
                        <br>
                        <div class="confidence">
                            <div>
                                <p>Confidence</p>
                                <div class="conf-level-container">
                                    <div class="conf-level" id="healthy-level"></div>
                                    <div class="conf-level" id="low-level"></div>
                                    <div class="conf-level" id="medium-level"></div>
                                    <div class="conf-level" id="high-level"></div>
                                </div>
                            </div>
                            <h3 id="type-confidence">High</h3>
                        </div>
                    </div>
                    <div class="right-side">
                        <div class="type-level-container">
                            <div class="type-level" id="type-healthy-level"></div>
                            <div class="type-level" id="type-low-level"></div>
                            <div class="type-level" id="type-medium-level"></div>
                            <div class="type-level" id="type-high-level"></div>
                        </div>
                    </div>
                </div>
                <hr>
                <div class="note">
                    <div>
                        <p>Note</p>
                        <p class="actual-note" id="note">You should do this..</p>
                    </div>
                </div>
            </div>
            <hr>
            <br>
            <div class="source-result">
                <p>Source of Result </p>
                <div class="source" id="source">-</div>
                <p>Related Symptoms</p>
                <div class="symptoms" id="symptoms">-</div>
            </div>
            <br><br>
            <hr>
            <br><br><br>
            <a href="index.html">
                <div class="redo-assess">
                    <p>Back to Home</p>
                </div>
            </a>
        </div>
        <script>
            const stored = localStorage.getItem("result");
            console.log(stored)
            var result;

            if (stored) {
                result = JSON.parse(stored); // Convert string back to object
                console.log("Status:", status); // "Normal" or whatever it was
            } else {
                console.log("No result found in localStorage.");
            }

            if (result) {
                document.getElementById("status").innerHTML = `<span>${result.Status}</span>`
                document.getElementById("confidence").innerHTML = `<span>${result.Confidence}</span>`
                document.getElementById("type").innerHTML = `<span>${result.Type}</span>`
                document.getElementById("type-confidence").innerHTML = `<span>${result.TypeConfidence}</span>`
                document.getElementById("note").innerHTML = `<span>${result.Note}</span>`
            }
            if (result.Source && result.Source.length > 0) {
                const sourceID = document.getElementById('source');
                sourceID.innerHTML =
                    `<div class="source-list">
                    ${result.Source.map(item => `<div class="source-item">${item}</div>`).join(' ')}
                </div> 
                    ` ;
            } else {
                document.querySelector('.source').innerHTML = '<span>No source available</span>';
            }

            if (result.SymptomSource && result.SymptomSource.length > 0) {
                const symptomsID = document.getElementById('symptoms');
                symptomsID.innerHTML =
                    `<div class="source-list">
                    ${result.SymptomSource.map(item => `<div class="source-item">${item}</div>`).join(' ')}
                </div> 
                    ` ;
            } else {
                document.querySelector('.symptoms').innerHTML = '<span>No related symptoms available</span>';
            }

            if (stored) {
                const status = result.Status;

                const root = document.documentElement;
                console.log("Status:", status);

                switch (status) {
                    case "Healthy":
                        root.style.setProperty("--main-color", "#4CAF50"); // green
                        break;
                    case "Moderate Acute Malnutrition (MAM)":
                        root.style.setProperty("--main-color", "#FFC107"); // yellow
                        break;
                    case "Severe Acute Malnutrition (SAM)":
                        root.style.setProperty("--main-color", "#A82424"); // red
                        break;
                    default:
                        root.style.setProperty("--main-color", "gray"); // fallback
                }
            }

        </script>
</body>

</html>